function isSessionTimeOutBannerDisplayed(){return sessionTimeOutBannerDisplayed}var box,sessionTimeOutBannerDisplayed=!1;$j(document).ready(function(){function e(e){d("receiveUpdatedTimeRemaining - timeout: "+e),f&&clearTimeout(f);var n;p>=e?(v||o(e),n=5e3):(r(!1),v=!1,n=1e3*e-1e3*p),d("receiveUpdatedTimeRemaining - Wake up in "+parseInt(n/1e3)+" for new timeout"),f=setTimeout(t,n)}function t(){s(e)}function n(){g||(d("checkLoadMessages - Loading message keys via ajax."),pss_get_texts("psx.js.keep_alive.keep_alive","psx.js.keep_alive.keep_alive.about_to_expire_title"),g=!0)}function s(e){d("getTimeout - Checking server for timeout"),n(),clearTimeout(f),$j.ajax({type:"GET",url:"/ws/session/seconds-remaining?_="+(new Date).getTime(),dataType:"json",context:document.body,success:function(t){m=t.Seconds.value,sessionStorage.uid=t.Seconds.uid,e(m)},statusCode:{401:function(){l()}}})}function i(e){sessionTimeOutBannerDisplayed||(null!==c&&(clearTimeout(f),$j.ajax({type:"PUT",url:"/ws/session/last-hit?seconds="+parseInt(((new Date).getTime()-c.getTime())/1e3),dataType:"json",context:document.body,success:function(t){m=t.Seconds.value,e(m)},statusCode:{401:function(){l()}}})),c=null)}function o(t){null!==c?i(e):u()}function a(){n(),box.html('<div id="sessiontimeoutwarningBox"><h2 class="warning"></h2><p class="warning"></p><button class="warning continueButton" type="button"></button><h2 class="signedout"></h2><p class="signedout"></p></div>'),box.find("h2.warning").html(pss_text("psx.js.keep_alive.keep_alive.about_to_expire_title")),box.find("p.warning").html(pss_text("psx.js.keep_alive.keep_alive.about_to_expire_text")),box.find("button.warning").html(pss_text("psx.js.keep_alive.keep_alive.continue")),box.find("h2.signedout").html(pss_text("psx.js.keep_alive.keep_alive.session_is_expired")),box.find("p.signedout").html(pss_text("psx.js.keep_alive.keep_alive.return_to_sign_in_page"));var t=box.find("p.signedout a"),s="/"+getPortal();t.attr("href",s+"?request_locale="+get_locale()),t.attr("data-type","sign_in"),box.find(".continueButton").click(function(){d("continueButton clicked"),c=new Date,i(e)})}function r(e){e?box.addClass("visible"):box.removeClass("visible")}function u(){a(),r(!0),v=!0}function l(){if(void 0!==typeof Storage&&(void 0===sessionStorage.timedOut||null===sessionStorage.timedOut)){var e=parent.document.getElementById("frameContent")?parent.document.getElementById("frameContent"):parent.document.getElementsByName("content")[0];if(void 0!==e&&null!==e){sessionStorage.framedPage="true",sessionStorage.url=window.parent.location.href,doc=e.contentDocument?e.contentDocument:e.document||e.contentWindow.document,sessionStorage.url!==doc.URL?sessionStorage.frameContentUrl=doc.URL:sessionStorage.framedPage="false";var t=$j(doc).find('input[name$="rn"]');t.length>0&&(sessionStorage.rns="",t.each(function(e,t){sessionStorage.rns+=$j(t).attr("name")+",",sessionStorage.setItem($j(t).attr("name"),$j(t).attr("value"))}))}else{var t=$j('input[name$="rn"]');t.length>0&&(sessionStorage.rns="",t.each(function(e,t){sessionStorage.rns+=$j(t).attr("name")+",",sessionStorage.setItem($j(t).attr("name"),$j(t).attr("value"))})),sessionStorage.url=window.location.href}if(-1===sessionStorage.url.indexOf("?")){var n=$j('input[name^="xselect"]');if(n.length>0){var s=n.attr("name");s=s.substring(1,s.length),sessionStorage.url=sessionStorage.url+"?"+s+"="+n.attr("value"),"xselectstudent"===n.attr("name")&&(sessionStorage.url=sessionStorage.url+"&homesearch="+$j('input[name="homesearch"]').attr("value"))}}sessionStorage.timedOut=!0}a(),box.addClass("signedout"),$j("body").append($j("<div/>",{"class":"signedout ui-widget-overlay ui-front security-overlay"})),r(!0),v=!0,sessionTimeOutBannerDisplayed=!0}function d(e){}var c=null,m=null,p=120,g=!1,v=!1,f=!1,_=$j("meta#keep-alive-config"),x,w=$j("meta#keep-alive-config-disabled");if(_&&0==w.length&&(x=_.attr("content")),x)if(box=$j('<div id="sessiontimeoutwarning" style="display: none" />'),$j(document.body).append(box),"menu"==window.name&&d("in a menu, no keep-alive; url="+window.location),"task_navigator"==window.name)d("in a task_navigator, no keep-alive; url="+window.location);else if($j("frameset").length)d("in a frameset, no keep-alive; url="+window.location);else{$j("body").on("mousedown keydown",function(t){var n=$j(t.target);n.is('a[data-type="sign_in"]')||(c=new Date,v&&i(e))});var j=60*x;p>j&&(p=.5*j,20>p&&(p=20));var b=new Date((new Date).getTime()+1e3*j);d("Init - session is set to expire in "+j+" seconds at "+b.toLocaleTimeString()),e(j)}});